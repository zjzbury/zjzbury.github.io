{
    "version": "https://jsonfeed.org/version/1",
    "title": "JAVA • All posts by \"javascript\" tag",
    "description": "爱编程，爱生活",
    "home_page_url": "http://www.startanew.cn",
    "items": [
        {
            "id": "http://www.startanew.cn/2021/06/05/js%E5%AE%9E%E7%8E%B0%E6%88%AA%E5%8F%96%E8%A7%86%E9%A2%91%E5%B0%81%E9%9D%A2%E5%8A%9F%E8%83%BD/",
            "url": "http://www.startanew.cn/2021/06/05/js%E5%AE%9E%E7%8E%B0%E6%88%AA%E5%8F%96%E8%A7%86%E9%A2%91%E5%B0%81%E9%9D%A2%E5%8A%9F%E8%83%BD/",
            "title": "js实现截取视频封面功能",
            "date_published": "2021-06-05T10:10:14.000Z",
            "content_html": "<h5 id=\"截图\"><a class=\"markdownIt-Anchor\" href=\"#截图\">#</a> 截图</h5>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//压缩图片</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">clipAndCompressCover</span>(<span class=\"params\">&#123; media, currentWidth, currentHeight, success &#125;</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// eslint-disable-next-line no-unused-vars</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> that = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> canvas = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;canvas&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">const</span> area = canvas.getContext(<span class=\"string\">&quot;2d&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">const</span> currentScale = currentWidth / currentHeight;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> targetScale = <span class=\"number\">750</span> / <span class=\"number\">420</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> targetWidth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> targetHeight = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> clipWidth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> clipHeight = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> quality = <span class=\"number\">0.95</span>; <span class=\"comment\">// 不要用1，会额外增大base64大小。</span></span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"comment\">// 根据视频宽高，决定截图大小</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (currentScale &gt;= targetScale) &#123;</span><br><span class=\"line\">      targetHeight = currentHeight &gt; <span class=\"number\">420</span> ? <span class=\"number\">420</span> : currentHeight;</span><br><span class=\"line\">      targetWidth = targetHeight * currentScale;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      targetWidth = currentWidth &gt; <span class=\"number\">750</span> ? <span class=\"number\">750</span> : currentWidth;</span><br><span class=\"line\">      targetHeight = targetWidth / currentScale;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    clipWidth = targetWidth &gt; <span class=\"number\">750</span> ? <span class=\"number\">750</span> : targetWidth;</span><br><span class=\"line\">    clipHeight = targetHeight &gt; <span class=\"number\">420</span> ? <span class=\"number\">420</span> : currentHeight;</span><br><span class=\"line\">    canvas.width = clipWidth;</span><br><span class=\"line\">    canvas.height = clipHeight;</span><br><span class=\"line\">  </span><br><span class=\"line\">    area.drawImage(</span><br><span class=\"line\">      media,</span><br><span class=\"line\">      (clipWidth - targetWidth) / <span class=\"number\">2</span>,</span><br><span class=\"line\">      (clipHeight - targetHeight) / <span class=\"number\">2</span>,</span><br><span class=\"line\">      targetWidth,</span><br><span class=\"line\">      targetHeight</span><br><span class=\"line\">    );</span><br><span class=\"line\">    <span class=\"keyword\">var</span> handler = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> base64 = canvas.toDataURL(<span class=\"string\">&quot;image/jpeg&quot;</span>, quality);</span><br><span class=\"line\">      getMediaSize(&#123; <span class=\"attr\">src</span>: base64 &#125;).then(<span class=\"function\"><span class=\"params\">response</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (response.size / <span class=\"number\">1024</span> &gt; <span class=\"number\">100</span>) &#123;</span><br><span class=\"line\">          quality -= <span class=\"number\">0.1</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">          <span class=\"keyword\">if</span> (quality &gt; <span class=\"number\">0.2</span>) &#123;</span><br><span class=\"line\">            handler();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          success &amp;&amp; success(base64);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    handler();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">//绘制视频封面图片</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> GetVideoCover = <span class=\"function\">(<span class=\"params\">&#123; url, time, success &#125;</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> video1 = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;video&quot;</span>);</span><br><span class=\"line\">    video1.src = url;</span><br><span class=\"line\">    video1.style.cssText = <span class=\"string\">&quot;position:fixed; top:0; left:-100%; visibility:hidden&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">//设置允许跨域</span></span><br><span class=\"line\">    video1.setAttribute(<span class=\"string\">&#x27;crossOrigin&#x27;</span>, <span class=\"string\">&#x27;anonymous&#x27;</span>);</span><br><span class=\"line\">    video1.onloadeddata = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">let</span> currentTime = time; <span class=\"comment\">//截图时间点</span></span><br><span class=\"line\">      video1.addEventListener(<span class=\"string\">&quot;timeupdate&quot;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        clipAndCompressCover(&#123;</span><br><span class=\"line\">          media: video1,</span><br><span class=\"line\">          currentWidth: video1.videoWidth,</span><br><span class=\"line\">          currentHeight: video1.videoHeight,</span><br><span class=\"line\">          success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">base64</span>) </span>&#123;</span><br><span class=\"line\">            video1.remove(video1);</span><br><span class=\"line\">            success(&#123;</span><br><span class=\"line\">              base64: base64</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">      video1.currentTime = currentTime &lt; <span class=\"number\">0</span> ? <span class=\"number\">1</span> : currentTime;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"comment\">// edge浏览器必须要追加到dom中，才能顺利执行相关事件。</span></span><br><span class=\"line\">    <span class=\"built_in\">document</span>.body.appendChild(video1);</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"><span class=\"comment\">// 获取媒体资源的大小，返回一个Promise对象。用于解决无法直接获取视频或图片的文件大小。</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getMediaSize</span>(<span class=\"params\">&#123;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    src</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">&#125;</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> xhr = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// eslint-disable-next-line no-unused-vars</span></span><br><span class=\"line\">        xhr.onreadystatechange = <span class=\"function\"><span class=\"params\">_</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (xhr.readyState === <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (xhr.status &gt;= <span class=\"number\">200</span> &amp;&amp; xhr.status &lt; <span class=\"number\">300</span> || xhr.status === <span class=\"number\">304</span>) &#123;</span><br><span class=\"line\">                    resolve(&#123;</span><br><span class=\"line\">                        size: xhr.response.size</span><br><span class=\"line\">                    &#125;);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    reject();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        xhr.open(<span class=\"string\">&#x27;get&#x27;</span>, URL.createObjectURL(transformBase64ToBlob(src)));</span><br><span class=\"line\">        xhr.responseType = <span class=\"string\">&#x27;blob&#x27;</span>;</span><br><span class=\"line\">        xhr.send();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">transformBase64ToBlob</span>(<span class=\"params\">base64</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> byteString;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (base64.split(<span class=\"string\">&#x27;,&#x27;</span>)[<span class=\"number\">0</span>].indexOf(<span class=\"string\">&#x27;base64&#x27;</span>) &gt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        byteString = atob(base64.split(<span class=\"string\">&#x27;,&#x27;</span>)[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        byteString = <span class=\"built_in\">unescape</span>(base64.split(<span class=\"string\">&#x27;,&#x27;</span>)[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">const</span> mimeString = base64.split(<span class=\"string\">&#x27;,&#x27;</span>)[<span class=\"number\">0</span>].split(<span class=\"string\">&#x27;:&#x27;</span>)[<span class=\"number\">1</span>].split(<span class=\"string\">&#x27;;&#x27;</span>)[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ia = <span class=\"keyword\">new</span> <span class=\"built_in\">Uint8Array</span>(byteString.length);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; byteString.length; i++) &#123;</span><br><span class=\"line\">        ia[i] = byteString.charCodeAt(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">const</span> blob = <span class=\"keyword\">new</span> Blob([ia], &#123;</span><br><span class=\"line\">        type: mimeString</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> blob;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span><br><span class=\"line\">    GetVideoCover,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>",
            "tags": [
                "javascript"
            ]
        },
        {
            "id": "http://www.startanew.cn/2021/06/05/video-js-%E4%BD%BF%E7%94%A8/",
            "url": "http://www.startanew.cn/2021/06/05/video-js-%E4%BD%BF%E7%94%A8/",
            "title": "video.js 使用",
            "date_published": "2021-06-05T09:33:00.000Z",
            "content_html": "<h3 id=\"官网地址\"><a class=\"markdownIt-Anchor\" href=\"#官网地址\">#</a> 官网地址</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3ZpZGVvanM=\">https://github.com/videojs</span></p>\n<h5 id=\"引入文件\"><a class=\"markdownIt-Anchor\" href=\"#引入文件\">#</a> 引入文件</h5>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;//vjs.zencdn.net/7.10.2/video-js.min.css&quot;</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;//vjs.zencdn.net/7.10.2/video.min.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"使用video标签\"><a class=\"markdownIt-Anchor\" href=\"#使用video标签\">#</a> 使用 video 标签</h5>\n<ul>\n<li>在不想手动初始化时，data-setup 必须加  <code>data-setup 设置一些参数</code></li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;video</span><br><span class=\"line\">    id=&quot;my-player&quot;</span><br><span class=\"line\">    class=&quot;video-js&quot;</span><br><span class=\"line\">    controls</span><br><span class=\"line\">    preload=&quot;auto&quot;</span><br><span class=\"line\">    poster=&quot;//vjs.zencdn.net/v/oceans.png&quot;</span><br><span class=\"line\">    data-setup=&#x27;&#123;&#125;&#x27;&gt;</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;//vjs.zencdn.net/v/oceans.mp4&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;video/mp4&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;//vjs.zencdn.net/v/oceans.webm&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;video/webm&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;//vjs.zencdn.net/v/oceans.ogv&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;video/ogg&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;vjs-no-js&quot;</span>&gt;</span></span><br><span class=\"line\">    To view this video please enable JavaScript, and consider upgrading to a</span><br><span class=\"line\">    web browser that</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;https://videojs.com/html5-video-support/&quot;</span> <span class=\"attr\">target</span>=<span class=\"string\">&quot;_blank&quot;</span>&gt;</span></span><br><span class=\"line\">      supports HTML5 video</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">video</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"手动初始化\"><a class=\"markdownIt-Anchor\" href=\"#手动初始化\">#</a> 手动初始化</h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> options = &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> player = videojs(<span class=\"string\">&#x27;my-player&#x27;</span>, options, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onPlayerReady</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  videojs.log(<span class=\"string\">&#x27;Your player is ready!&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// In this context, `this` is the player that was created by Video.js.</span></span><br><span class=\"line\">  <span class=\"built_in\">this</span>.play();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// How about an event listener?</span></span><br><span class=\"line\">  <span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;ended&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    videojs.log(<span class=\"string\">&#x27;Awww...over so soon?!&#x27;</span>);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h5 id=\"常用配置项\"><a class=\"markdownIt-Anchor\" href=\"#常用配置项\">#</a> 常用配置项</h5>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">autoplay: false, &#x2F;&#x2F;自动播放：true&#x2F;false</span><br><span class=\"line\">controls: true, &#x2F;&#x2F;是否显示底部控制栏：true&#x2F;false</span><br><span class=\"line\">width: 300, &#x2F;&#x2F;视频播放器显示的宽度</span><br><span class=\"line\">height: 300, &#x2F;&#x2F;视频播放器显示的高度</span><br><span class=\"line\">loop: false, &#x2F;&#x2F;是否循环播放:true&#x2F;false</span><br><span class=\"line\">muted: false, &#x2F;&#x2F;设置默认播放音频：true&#x2F;false</span><br><span class=\"line\">poster:&quot;&quot;, &#x2F;&#x2F;视频开始播放前显示的图像的URL。这通常是一个帧的视频或自定义标题屏幕。一旦用户点击“播放”图像就会消失</span><br><span class=\"line\">src:&quot;&quot;, &#x2F;&#x2F;要嵌入的视频资源url，The source URL to a video source to embed.</span><br><span class=\"line\">techOrder: [&#39;html5&#39;, &#39;flash&#39;], &#x2F;&#x2F;使用播放器的顺序,下面的示例说明优先使用html5播放器，如果不支持将使用flash</span><br><span class=\"line\">notSupportedMessage: false, &#x2F;&#x2F;是否允许重写默认的消息显示出来时，video.js无法播放媒体源</span><br><span class=\"line\">plugins: &#123;&#125;, &#x2F;&#x2F;插件</span><br><span class=\"line\">sources: [&#123;src: &#39;&#x2F;&#x2F;path&#x2F;to&#x2F;video.mp4&#39;, type: &#39;video&#x2F;mp4&#39;&#125;] &#x2F;&#x2F;资源文件等价于html中的形式source标签 </span><br><span class=\"line\">aspectRatio:&quot;1:1&quot; &#x2F;&#x2F;将播放器置于流体模式下，计算播放器动态大小时使用该值。</span><br><span class=\"line\"> \t\t\t\t  &#x2F;&#x2F;该值应该是比用冒号隔开的两个数字（如“16:9”或“4:3”）。</span><br><span class=\"line\">fluid: false,\t&#x2F;&#x2F;是否自适应布局,播放器将会有流体体积。换句话说，它将缩放以适应容器。</span><br><span class=\"line\">\t\t\t\t&#x2F;&#x2F; 如果&lt;video&gt;标签有“vjs-fluid”样式时，这个选项会自动设置为true。</span><br><span class=\"line\">preload: &quot;metadata&quot;, &#x2F;&#x2F;建议浏览器是否在加载&lt;video&gt;元素时开始下载视频数据。(预加载)</span><br><span class=\"line\">\t\t&#x2F;&#x2F;auto:立即加载视频（如果浏览器支持它）。一些移动设备将不会预加载视频，以保护用户的带宽&#x2F;数据使用率。这就是为什么这个值被称为“自动”，而不是更确凿的东西</span><br><span class=\"line\">\t\t&#x2F;&#x2F; metadata:只加载视频的元数据，其中包括视频的持续时间和尺寸等信息。有时，元数据会通过下载几帧视频来加载。</span><br><span class=\"line\">\t\t&#x2F;&#x2F;none</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h5 id=\"常用事件\"><a class=\"markdownIt-Anchor\" href=\"#常用事件\">#</a> 常用事件</h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;suspend&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//延迟下载</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;延迟下载&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;loadstart&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">//客户端开始请求数据</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;客户端开始请求数据&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;progress&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//客户端正在请求数据</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;客户端正在请求数据&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;abort&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//客户端主动终止下载（不是因为错误引起）</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;客户端主动终止下载&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;error&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//请求数据时遇到错误</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;请求数据时遇到错误&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;stalled&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//网速失速</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;网速失速&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;play&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//开始播放</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;开始播放&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;pause&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//暂停</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;暂停&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;loadedmetadata&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//成功获取资源长度</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;成功获取资源长度&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;loadeddata&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//渲染播放画面</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;渲染播放画面&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;waiting&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//等待数据，并非错误</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;等待数据&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;playing&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//开始回放</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;开始回放&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;canplay&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//可以播放，但中途可能因为加载而暂停</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;可以播放，但中途可能因为加载而暂停&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;canplaythrough&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">//可以播放，歌曲全部加载完毕</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;可以播放，歌曲全部加载完毕&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;seeking&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123; <span class=\"comment\">//寻找中</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;寻找中&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;seeked&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//寻找完毕</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;寻找完毕&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;timeupdate&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//播放时间改变</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;播放时间改变&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;ended&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//播放结束</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;播放结束&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;ratechange&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//播放速率改变</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;播放速率改变&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;durationchange&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//资源长度改变</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;资源长度改变&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"built_in\">this</span>.on(<span class=\"string\">&#x27;volumechange&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">//音量改变</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;音量改变&quot;</span>)</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h5 id=\"常用方法\"><a class=\"markdownIt-Anchor\" href=\"#常用方法\">#</a> 常用方法</h5>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">play() 播放</span><br><span class=\"line\">pause() 暂停</span><br><span class=\"line\">currentTime() 获取播放进度</span><br><span class=\"line\">currentTime(120) 设置播放进度</span><br><span class=\"line\">duration()  视频持续时间，加载完成视频才可以知道视频时长，且在flash情况下无效</span><br><span class=\"line\">buffered() 缓冲，返回下载进度</span><br><span class=\"line\">bufferedPercent()百分比的缓冲</span><br><span class=\"line\">volume() 声音大小（0-1之间）</span><br><span class=\"line\">volume(0.5) 设置声音大小</span><br><span class=\"line\">width() 取得视频的宽度</span><br><span class=\"line\">width(640) 设置宽度</span><br><span class=\"line\">height() 获取高度</span><br><span class=\"line\">height(480); 设置高度</span><br><span class=\"line\">size(640,480);设置宽高</span><br><span class=\"line\">enterFullScreen(); 全屏</span><br><span class=\"line\">enterFullScreen(); 退出全屏</span><br><span class=\"line\">dispose(); 销毁</span><br></pre></td></tr></table></figure>\n<h5 id=\"网络状态\"><a class=\"markdownIt-Anchor\" href=\"#网络状态\">#</a> 网络状态</h5>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">currentSrc; &#x2F;&#x2F;返回当前资源的URL</span><br><span class=\"line\">src &#x3D; value; &#x2F;&#x2F;返回或设置当前资源的URL</span><br><span class=\"line\">canPlayType(type); &#x2F;&#x2F;是否能播放某种格式的资源</span><br><span class=\"line\">networkState; &#x2F;&#x2F;0.此元素未初始化 1.正常但没有使用网络 2.正在下载数据 3.没有找到资源</span><br><span class=\"line\">load(); &#x2F;&#x2F;重新加载src指定的资源</span><br><span class=\"line\">buffered; &#x2F;&#x2F;返回已缓冲区域，TimeRanges</span><br><span class=\"line\">preload; &#x2F;&#x2F;none:不预载 metadata:预载资源信息 auto:立即加载视频</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h5 id=\"播放状态\"><a class=\"markdownIt-Anchor\" href=\"#播放状态\">#</a> 播放状态</h5>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">currentTime &#x3D; value; &#x2F;&#x2F;当前播放的位置，赋值可改变位置</span><br><span class=\"line\">startTime; &#x2F;&#x2F;一般为0，如果为流媒体或者不从0开始的资源，则不为0</span><br><span class=\"line\">duration; &#x2F;&#x2F;当前资源长度 流返回无限</span><br><span class=\"line\">paused; &#x2F;&#x2F;是否暂停</span><br><span class=\"line\">defaultPlaybackRate &#x3D; value;&#x2F;&#x2F;默认的回放速度，可以设置</span><br><span class=\"line\">playbackRate &#x3D; value;&#x2F;&#x2F;当前播放速度，设置后马上改变</span><br><span class=\"line\">played; &#x2F;&#x2F;返回已经播放的区域，TimeRanges，关于此对象见下文</span><br><span class=\"line\">seekable; &#x2F;&#x2F;返回可以seek的区域 TimeRanges</span><br><span class=\"line\">ended; &#x2F;&#x2F;是否结束</span><br><span class=\"line\">autoPlay; &#x2F;&#x2F;是否自动播放</span><br><span class=\"line\">loop; &#x2F;&#x2F;是否循环播放</span><br></pre></td></tr></table></figure>\n<h5 id=\"视频控制\"><a class=\"markdownIt-Anchor\" href=\"#视频控制\">#</a> 视频控制</h5>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">controls;&#x2F;&#x2F;是否有默认控制条</span><br><span class=\"line\">volume &#x3D; value; &#x2F;&#x2F;音量</span><br><span class=\"line\">muted &#x3D; value; &#x2F;&#x2F;静音</span><br></pre></td></tr></table></figure>\n<h5 id=\"播放按钮美化\"><a class=\"markdownIt-Anchor\" href=\"#播放按钮美化\">#</a> 播放按钮美化</h5>\n<blockquote>\n<p>播放按钮居中</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">video</span>  <span class=\"attr\">class</span>=<span class=\"string\">&quot;video-js vjs-default-skin vjs-big-play-centered&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>暂停时显示播放按钮</p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.vjs-paused</span> <span class=\"selector-class\">.vjs-big-play-button</span>,</span><br><span class=\"line\"><span class=\"selector-class\">.vjs-paused</span><span class=\"selector-class\">.vjs-has-started</span> <span class=\"selector-class\">.vjs-big-play-button</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>播放按钮变成圆形</p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.video-js</span> <span class=\"selector-class\">.vjs-big-play-button</span>&#123;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">2.5em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">2.3em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">2.5em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">2.5em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-border-radius</span>: <span class=\"number\">2.5em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-moz-border-radius</span>: <span class=\"number\">2.5em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">2.5em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"number\">#73859f</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">115</span>,<span class=\"number\">133</span>,<span class=\"number\">159</span>,.<span class=\"number\">5</span>);</span><br><span class=\"line\">    <span class=\"attribute\">border-width</span>: <span class=\"number\">0.15em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin-top</span>: -<span class=\"number\">1.25em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin-left</span>: -<span class=\"number\">1.75em</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 中间的播放箭头 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.vjs-big-play-button</span> <span class=\"selector-class\">.vjs-icon-placeholder</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">1.63em</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 加载圆圈 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.vjs-loading-spinner</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">2.5em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">2em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">2em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">1em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin-top</span>: -<span class=\"number\">1em</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin-left</span>: -<span class=\"number\">1.5em</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "javascript"
            ]
        },
        {
            "id": "http://www.startanew.cn/2020/12/31/JavaScript%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E5%8C%96/",
            "url": "http://www.startanew.cn/2020/12/31/JavaScript%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E5%8C%96/",
            "title": "JavaScript日期格式化",
            "date_published": "2020-12-31T08:04:51.000Z",
            "content_html": "<h3 id=\"javascript代码\"><a class=\"markdownIt-Anchor\" href=\"#javascript代码\">#</a> JavaScript 代码</h3>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Date</span>.prototype.Format = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">fmt</span>) </span>&#123; </span><br><span class=\"line\">    <span class=\"keyword\">var</span> o = &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;M+&quot;</span>: <span class=\"built_in\">this</span>.getMonth() + <span class=\"number\">1</span>, <span class=\"comment\">//月份</span></span><br><span class=\"line\">        <span class=\"string\">&quot;d+&quot;</span>: <span class=\"built_in\">this</span>.getDate(), <span class=\"comment\">//日</span></span><br><span class=\"line\">        <span class=\"string\">&quot;H+&quot;</span>: <span class=\"built_in\">this</span>.getHours(), <span class=\"comment\">//小时</span></span><br><span class=\"line\">        <span class=\"string\">&quot;m+&quot;</span>: <span class=\"built_in\">this</span>.getMinutes(), <span class=\"comment\">//分</span></span><br><span class=\"line\">        <span class=\"string\">&quot;s+&quot;</span>: <span class=\"built_in\">this</span>.getSeconds(), <span class=\"comment\">//秒</span></span><br><span class=\"line\">        <span class=\"string\">&quot;q+&quot;</span>: <span class=\"built_in\">Math</span>.floor((<span class=\"built_in\">this</span>.getMonth() + <span class=\"number\">3</span>) / <span class=\"number\">3</span>), <span class=\"comment\">//季度</span></span><br><span class=\"line\">        <span class=\"string\">&quot;S&quot;</span>: <span class=\"built_in\">this</span>.getMilliseconds() <span class=\"comment\">//毫秒</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"regexp\">/(y+)/</span>.test(fmt)) fmt = fmt.replace(<span class=\"built_in\">RegExp</span>.$1, (<span class=\"built_in\">this</span>.getFullYear() + <span class=\"string\">&quot;&quot;</span>).substr(<span class=\"number\">4</span> - <span class=\"built_in\">RegExp</span>.$1.length));</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> k <span class=\"keyword\">in</span> o)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">new</span> <span class=\"built_in\">RegExp</span>(<span class=\"string\">&quot;(&quot;</span> + k + <span class=\"string\">&quot;)&quot;</span>).test(fmt)) fmt = fmt.replace(<span class=\"built_in\">RegExp</span>.$1, (<span class=\"built_in\">RegExp</span>.$1.length == <span class=\"number\">1</span>) ? (o[k]) : ((<span class=\"string\">&quot;00&quot;</span> + o[k]).substr((<span class=\"string\">&quot;&quot;</span> + o[k]).length)));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fmt;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "javascript"
            ]
        },
        {
            "id": "http://www.startanew.cn/2020/12/30/JavaScript%E5%A4%8D%E5%88%B6%E6%96%87%E6%9C%AC/",
            "url": "http://www.startanew.cn/2020/12/30/JavaScript%E5%A4%8D%E5%88%B6%E6%96%87%E6%9C%AC/",
            "title": "JavaScript复制文本",
            "date_published": "2020-12-30T06:14:46.000Z",
            "content_html": "<h3 id=\"javascript代码\"><a class=\"markdownIt-Anchor\" href=\"#javascript代码\">#</a> JavaScript 代码</h3>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">copy</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> input = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&#x27;input&#x27;</span>);</span><br><span class=\"line\">    input.setAttribute(<span class=\"string\">&#x27;readonly&#x27;</span>, <span class=\"string\">&#x27;readonly&#x27;</span>); <span class=\"comment\">// 防止手机上弹出软键盘</span></span><br><span class=\"line\">    input.setAttribute(<span class=\"string\">&#x27;value&#x27;</span>,  $(<span class=\"string\">&quot;#id&quot;</span>).text()); <span class=\"comment\">//赋值</span></span><br><span class=\"line\">    <span class=\"built_in\">document</span>.body.appendChild(input);</span><br><span class=\"line\">    input.select();<span class=\"comment\">//选中</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> res = <span class=\"built_in\">document</span>.execCommand(<span class=\"string\">&#x27;copy&#x27;</span>);  <span class=\"comment\">//拷贝</span></span><br><span class=\"line\">    <span class=\"built_in\">document</span>.body.removeChild(input);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (res)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;复制成功&quot;</span>);</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;复制失败&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "javascript"
            ]
        },
        {
            "id": "http://www.startanew.cn/2020/11/12/XMLHttpRequest%20%E5%BC%82%E6%AD%A5%E4%B8%8B%E8%BD%BD/",
            "url": "http://www.startanew.cn/2020/11/12/XMLHttpRequest%20%E5%BC%82%E6%AD%A5%E4%B8%8B%E8%BD%BD/",
            "title": "XMLHttpRequest 异步下载",
            "date_published": "2020-11-12T12:41:00.000Z",
            "content_html": "<h3 id=\"原文链接-httpswwwjianshucomp1e189c14aa98\"><a class=\"markdownIt-Anchor\" href=\"#原文链接-httpswwwjianshucomp1e189c14aa98\">#</a> 原文链接 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8xZTE4OWMxNGFhOTg=\">https://www.jianshu.com/p/1e189c14aa98</span></h3>\n<h5 id=\"网络请求\"><a class=\"markdownIt-Anchor\" href=\"#网络请求\">#</a> 网络请求</h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">get</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> xhr = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> url = <span class=\"string\">&quot;请求地址&quot;</span>;</span><br><span class=\"line\">    xhr.open(<span class=\"string\">&quot;POST&quot;</span>, url);</span><br><span class=\"line\">    xhr.setRequestHeader(<span class=\"string\">&quot;Content-Type&quot;</span>, <span class=\"string\">&quot;application/json;charset=UTF-8&quot;</span>);</span><br><span class=\"line\">    xhr.responseType = <span class=\"string\">&quot;blob&quot;</span>;</span><br><span class=\"line\">    xhr.addEventListener(<span class=\"string\">&quot;loadstart&quot;</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">ev</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 开始下载事件：下载进度条的显示</span></span><br><span class=\"line\">        $(<span class=\"string\">&quot;#progress-dialog&quot;</span>).modal(<span class=\"string\">&#x27;show&#x27;</span>)</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    xhr.addEventListener(<span class=\"string\">&quot;load&quot;</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">ev</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 下载完成事件：处理下载文件</span></span><br><span class=\"line\">        processRequest(xhr);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    xhr.addEventListener(<span class=\"string\">&quot;progress&quot;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">ev</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 下载中事件：计算下载进度</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> max   = ev.total;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> value = ev.loaded;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> width = value/max*<span class=\"number\">100</span>;</span><br><span class=\"line\">       </span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">     xhr.addEventListener(<span class=\"string\">&quot;loadend&quot;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">ev</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 结束下载事件：下载进度条的关闭</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    xhr.addEventListener(<span class=\"string\">&quot;error&quot;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">ev</span>) </span>&#123;</span><br><span class=\"line\">      </span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    xhr.addEventListener(<span class=\"string\">&quot;abort&quot;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">ev</span>) </span>&#123;</span><br><span class=\"line\">     </span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    xhr.send(<span class=\"built_in\">JSON</span>.stringify(&#123;</span><br><span class=\"line\">       <span class=\"comment\">//参数</span></span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h5 id=\"下载文件\"><a class=\"markdownIt-Anchor\" href=\"#下载文件\">#</a> 下载文件</h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">processRequest</span>(<span class=\"params\">xhr</span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(xhr)</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (xhr.status == <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> response = xhr.response;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> contentType = xhr.getResponseHeader(<span class=\"string\">&quot;Content-Type&quot;</span>);</span><br><span class=\"line\">          <span class=\"keyword\">if</span>(contentType.split(<span class=\"string\">&quot;;&quot;</span>)[<span class=\"number\">0</span>] == <span class=\"string\">&quot;application/json&quot;</span>)&#123;</span><br><span class=\"line\">              <span class=\"keyword\">var</span> reader = <span class=\"keyword\">new</span> FileReader();</span><br><span class=\"line\">              reader.readAsText(response);</span><br><span class=\"line\">              reader.onload = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">oFREvent</span>) </span>&#123;</span><br><span class=\"line\">                  <span class=\"comment\">// 后端返回的json数据</span></span><br><span class=\"line\">              &#125;;</span><br><span class=\"line\">          &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (contentType.split(<span class=\"string\">&quot;;&quot;</span>)[<span class=\"number\">0</span>] == <span class=\"string\">&quot;application/octet-stream&quot;</span>)&#123;</span><br><span class=\"line\">              <span class=\"keyword\">var</span> fileName =  xhr.getResponseHeader(<span class=\"string\">&quot;content-disposition&quot;</span>).split(<span class=\"string\">&quot;=&quot;</span>)[<span class=\"number\">1</span>];</span><br><span class=\"line\">              saveFile(response, <span class=\"built_in\">decodeURI</span>(fileName))</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> response = xhr.response;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> contentType = xhr.getResponseHeader(<span class=\"string\">&quot;Content-Type&quot;</span>)</span><br><span class=\"line\">          <span class=\"keyword\">if</span>(contentType.split(<span class=\"string\">&quot;;&quot;</span>)[<span class=\"number\">0</span>] == <span class=\"string\">&quot;application/json&quot;</span>)&#123;</span><br><span class=\"line\">              <span class=\"keyword\">var</span> reader = <span class=\"keyword\">new</span> FileReader();</span><br><span class=\"line\">              reader.readAsText(response);</span><br><span class=\"line\">              reader.onload = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">oFREvent</span>) </span>&#123;</span><br><span class=\"line\">                  <span class=\"comment\">//请求异常</span></span><br><span class=\"line\">              &#125;;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h5 id=\"保存文件\"><a class=\"markdownIt-Anchor\" href=\"#保存文件\">#</a> 保存文件</h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">saveFile</span>(<span class=\"params\">blob, fileName</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> b = getBrowser();</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (b == <span class=\"string\">&quot;Chrome&quot;</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> link = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&#x27;a&#x27;</span>);</span><br><span class=\"line\">          <span class=\"keyword\">var</span> file = <span class=\"keyword\">new</span> Blob([blob], &#123;<span class=\"attr\">type</span>: <span class=\"string\">&#x27;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#x27;</span>&#125;);</span><br><span class=\"line\">          link.href = <span class=\"built_in\">window</span>.URL.createObjectURL(file);</span><br><span class=\"line\">          link.download = fileName;</span><br><span class=\"line\">          link.click();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (b == <span class=\"string\">&quot;Firefox&quot;</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> file = <span class=\"keyword\">new</span> File([blob], fileName, &#123;<span class=\"attr\">type</span>: <span class=\"string\">&#x27;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#x27;</span>&#125;);</span><br><span class=\"line\">          <span class=\"keyword\">var</span> url = URL.createObjectURL(file);</span><br><span class=\"line\">          <span class=\"comment\">//window.location.href = url;</span></span><br><span class=\"line\">          parent.location.href = url;</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (b == <span class=\"string\">&quot;IE&quot;</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> file = <span class=\"keyword\">new</span> Blob([blob], &#123;<span class=\"attr\">type</span>: <span class=\"string\">&#x27;application/force-download&#x27;</span>&#125;);</span><br><span class=\"line\">          <span class=\"built_in\">window</span>.navigator.msSaveBlob(file, fileName);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h5 id=\"判断浏览器\"><a class=\"markdownIt-Anchor\" href=\"#判断浏览器\">#</a> 判断浏览器</h5>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getBrowser</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">       <span class=\"keyword\">var</span> ua = <span class=\"built_in\">window</span>.navigator.userAgent;</span><br><span class=\"line\">       <span class=\"keyword\">var</span> isIE = !!<span class=\"built_in\">window</span>.ActiveXObject || <span class=\"string\">&quot;ActiveXObject&quot;</span> <span class=\"keyword\">in</span> <span class=\"built_in\">window</span>;</span><br><span class=\"line\">       <span class=\"keyword\">var</span> isFirefox = ua.indexOf(<span class=\"string\">&quot;Firefox&quot;</span>) != -<span class=\"number\">1</span>;</span><br><span class=\"line\">       <span class=\"keyword\">var</span> isOpera = <span class=\"built_in\">window</span>.opr != <span class=\"literal\">undefined</span>;</span><br><span class=\"line\">       <span class=\"keyword\">var</span> isChrome = ua.indexOf(<span class=\"string\">&quot;Chrome&quot;</span>) &amp;&amp; <span class=\"built_in\">window</span>.chrome;</span><br><span class=\"line\">       <span class=\"keyword\">var</span> isSafari = ua.indexOf(<span class=\"string\">&quot;Safari&quot;</span>) != -<span class=\"number\">1</span> &amp;&amp; ua.indexOf(<span class=\"string\">&quot;Version&quot;</span>) != -<span class=\"number\">1</span>;</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (isIE) &#123;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> <span class=\"string\">&quot;IE&quot;</span>;</span><br><span class=\"line\">       &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (isFirefox) &#123;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> <span class=\"string\">&quot;Firefox&quot;</span>;</span><br><span class=\"line\">       &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (isOpera) &#123;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> <span class=\"string\">&quot;Opera&quot;</span>;</span><br><span class=\"line\">       &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (isChrome) &#123;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> <span class=\"string\">&quot;Chrome&quot;</span>;</span><br><span class=\"line\">       &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (isSafari) &#123;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> <span class=\"string\">&quot;Safari&quot;</span>;</span><br><span class=\"line\">       &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> <span class=\"string\">&quot;Unkown&quot;</span>;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "javascript"
            ]
        }
    ]
}